import{o as n,c as v,w as s,a as e,b as l,g as d,l as i,e as m,F as h,h as f,t as p,q as k,p as g,v as P,f as _,D as S,T as V,u as b,j as $}from"./app-BJOG9bys.js";import{_ as D}from"./WunjoLayout-DFe1lN8a.js";import{_ as T}from"./FormSection-2vuET-xT.js";import{_ as x}from"./InputError-Dcl8-r1v.js";import{_ as u}from"./InputLabel-hx10P8Dl.js";import{_ as j}from"./PrimaryButton-BERJt-vl.js";import"./NavLink-C6vHIAsw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"grid grid-cols-2"},M={class:"m-2"},U=["value"],F={class:"rounded-lg m-2"},O={class:"relative max-w-sm"},q=e("div",{class:"absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),E={key:0},B={key:0,class:"p-1 grid grid-cols-1 gap-2"},N={class:"w-full flex flex-row flex-no-wrap sm:bg-white rounded-lg overflow-hidden sm:shadow-lg my-5"},H=e("thead",{class:"text-white"},[e("tr",{class:"bg-gray-200 text-gray-500 flex flex-col flex-no wrap sm:table-row rounded-l-lg sm:rounded-none mb-2 sm:mb-0"},[e("th",{class:"p-3 text-center"},"Fecha"),e("th",{class:"p-3 text-center"},"Monto"),e("th",{class:"p-3 text-center"},"Paquete?"),e("th",{class:"p-3 text-center"},"Seleccionar")])],-1),A={class:"flex-1 sm:flex-none"},L={class:"flex flex-col flex-no wrap sm:table-row mb-2 sm:mb-0"},R={class:"text-center border-grey-light border p-3"},z={class:"text-center border-grey-light border p-3"},Z={class:"text-center border-grey-light border p-3"},W={class:"text-center border-grey-light border p-3 truncate"},G=["onUpdate:modelValue","onChange"],I={class:"grid grid-cols-2"},J={class:"m-2"},K={class:"m-2"},Q={class:"grid grid-cols-2"},X={class:"rounded-md"},Y=["value"],ee={class:"m-2"},re={class:"grid grid-cols-2"},te={class:"rounded-md"},ae={class:"m-2"},oe={class:"my-4 mx-2"},se=e("p",{class:"mt-1 text-sm text-gray-400 dark:text-gray-300",id:"file_input_text"}," Comprobante de pago. ",-1),le=e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),de={name:"UsersForm",data(){return{payrollDetail:[],amountTotal:0,porcentualPay:0,employeeSelect:[],method_pay:[],reference:"",amountPayroll:0,concept:"",file:null}},methods:{changeFormat(o){let t=o.split("-");return t[2]+"/"+t[1]+"/"+t[0]},selectFile(o){this.file=o.target.files[0]},SearchWorked(o){this.employeeSelect=o,this.form.payrollsDetails=[],this.payrollDetail=[],this.amountTotal=0,this.porcentualPay=0,S.visit("searchworked",{method:"post",data:{employee:o.id},preserveState:!0,preserveScroll:!0,onSuccess:t=>{let a=t.props.jetstream.flash.consultations,r=0,y=!1;a.forEach((c,he)=>{c.haspackage==!0?(r=c.amount+this.therapy.price,y=!0):r=c.amount;let w={consultation_id:c.id,date:c.date,amount:r,haspackage:y};this.payrollDetail.push(w)})},onError:t=>{console.log("erros")}})},selectDetail(o,t){o==!0?(this.form.payrollsDetails.push(t),this.amountTotal=this.amountTotal+t.amount,this.porcentualPay=Math.floor(this.amountTotal*this.employeeSelect.mount)/100):this.form.payrollsDetails.forEach((a,r)=>{a.consultation_id==t.consultation_id&&(this.amountTotal=this.amountTotal-t.amount,this.form.payrollsDetails.splice(r,1),this.porcentualPay=Math.floor(this.amountTotal*this.employeeSelect.mount)/100)})},Formvalidate(){if(this.employeeSelect.contract=="PORCENTUAL"&&this.form.payrollsDetails.length==0){alert("Debe seleccionar al menos una consulta de la lista para procesar el pago");return}if(this.employeeSelect.contract=="PORCENTUAL"&&this.amountPayroll!=this.porcentualPay){alert("El monto a pagar deber ser igual al calculo determinado por el sistema.");return}if(this.method_pay.length==0||this.concept==""||this.reference==""||this.amountPayroll==0){alert("Debes llenar los campos de pago correctamente");return}return this.form.employee=this.employeeSelect.id,this.form.amount=this.amountPayroll,this.form.concept=this.concept,this.form.payment_methods_id=this.method_pay.id,this.form.amount_pay=this.amountPayroll,this.form.reference=this.reference,this.form.capture=this.file,this.$emit("submit")}}},ne=Object.assign(de,{props:{form:{type:Object,required:!0},employees:{type:Object,required:!0},payment_methods:{type:Object,required:!0},therapy:{type:Object,required:!0},updating:{type:Boolean,required:!1,default:!1}},emits:["submit"],setup(o){return(t,a)=>(n(),v(T,{onSubmitted:a[10]||(a[10]=r=>t.Formvalidate()),class:"w-full"},{form:s(()=>[e("div",C,[e("div",M,[l(u,{for:"status"},{default:s(()=>[d("Empleado")]),_:1}),i(e("select",{id:"employee","onUpdate:modelValue":a[0]||(a[0]=r=>o.form.employee=r),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:a[1]||(a[1]=r=>t.SearchWorked(o.form.employee))},[(n(!0),m(h,null,f(o.employees,r=>(n(),m("option",{value:r},p(r.fist_name)+" "+p(r.last_name),9,U))),256))],544),[[k,o.form.employee]]),l(x,{message:t.$page.props.errors.employee_id},null,8,["message"])]),e("div",F,[l(u,{for:"date"},{default:s(()=>[d("Fecha")]),_:1}),e("div",O,[q,i(e("input",{datepicker:"","datepicker-buttons":"","datepicker-autoselect-today":"",type:"date","onUpdate:modelValue":a[2]||(a[2]=r=>o.form.date=r),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[g,o.form.date]])]),l(x,{message:t.$page.props.errors.date},null,8,["message"])])]),t.employeeSelect.contract=="PORCENTUAL"?(n(),m("div",E,[t.payrollDetail.length>0?(n(),m("div",B,[l(u,{for:"name"},{default:s(()=>[d("Seleccionar las consultas ")]),_:1}),e("table",N,[H,(n(!0),m(h,null,f(t.payrollDetail,(r,y)=>(n(),m("tbody",A,[e("tr",L,[e("td",R,p(t.changeFormat(r.date)),1),e("td",z,p(r.amount),1),e("td",Z,p(r.haspackage==!1?"NO":"SI"),1),e("td",W,[i(e("input",{type:"checkbox","onUpdate:modelValue":c=>r.checked=c,onChange:c=>t.selectDetail(r.checked,r),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,40,G),[[P,r.checked]])])])]))),256))])])):_("",!0),e("div",I,[e("div",J,[l(u,{for:"name"},{default:s(()=>[d("Monto Total ")]),_:1}),i(e("input",{type:"number",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500","onUpdate:modelValue":a[3]||(a[3]=r=>t.amountTotal=r),id:"amountTotal",disabled:""},null,512),[[g,t.amountTotal]])]),e("div",K,[l(u,{for:"name"},{default:s(()=>[d("Monto Porcentual a pagar")]),_:1}),i(e("input",{type:"number",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500","onUpdate:modelValue":a[4]||(a[4]=r=>t.porcentualPay=r),id:"porcentualPay",disabled:""},null,512),[[g,t.porcentualPay]])])])])):_("",!0),e("div",Q,[e("div",X,[l(u,{for:"name"},{default:s(()=>[d("Metodo de Pago")]),_:1}),i(e("select",{class:"block appearance-none w-full bg-gray-100 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"method_pay",placeholder:"Monto a pagar","onUpdate:modelValue":a[5]||(a[5]=r=>t.method_pay=r)},[(n(!0),m(h,null,f(o.payment_methods,r=>(n(),m("option",{value:r},p(r.name),9,Y))),256))],512),[[k,t.method_pay]])]),e("div",ee,[l(u,{for:"name"},{default:s(()=>[d("Monto de pago")]),_:1}),i(e("input",{type:"number",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500","onUpdate:modelValue":a[6]||(a[6]=r=>t.amountPayroll=r),id:"amountPayroll",step:".01"},null,512),[[g,t.amountPayroll]])])]),e("div",re,[e("div",te,[l(u,{for:"name"},{default:s(()=>[d("Concepto de pago")]),_:1}),i(e("input",{type:"text",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500","onUpdate:modelValue":a[7]||(a[7]=r=>t.concept=r),id:"concept"},null,512),[[g,t.concept]])]),e("div",ae,[l(u,{for:"name"},{default:s(()=>[d("Referencia")]),_:1}),i(e("input",{type:"text",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500","onUpdate:modelValue":a[8]||(a[8]=r=>t.reference=r),id:"reference"},null,512),[[g,t.reference]])])]),e("div",oe,[e("input",{class:"w-full text-sm text-gray-600 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400","aria-describedby":"Comprobante de pago",id:"file_reference",type:"file",onChange:a[9]||(a[9]=(...r)=>t.selectFile&&t.selectFile(...r))},null,32),se])]),actions:s(()=>[l(j,{class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},{default:s(()=>[le,d(" "+p(o.updating?"Actualizar":"Generar Pago"),1)]),_:1})]),_:1}))}}),ie={class:"w-[90%] mx-auto rounded-lg border border-gray-200 p-5 m-5 grid grid-cols-1 gap-3"},ue={class:"flex-no text-center justify-center mb-5 text-sm md:text-md lg:text-lg md:justify-between lg:justify-between md:flex lg:flex"},ce=e("h1",{class:"flex text-center font-semibold text-gray-700"}," Formulario de pago ",-1),me=e("svg",{class:"h-6 w-6 text-white",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{stroke:"none",d:"M0 0h24v24H0z"}),e("path",{d:"M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),e("path",{d:"M20 12h-13l3 -3m0 6l-3 -3"})],-1),pe={class:"bg-white rounded-lg shadow dark:bg-gray-700 grid grid-cols-1 gap-3"},ge=e("div",{class:"items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"},null,-1),ye={name:"PaymentCreate",data(){return{}},methods:{}},Se=Object.assign(ye,{props:{employees:{type:Object,required:!0},payment_methods:{type:Object,required:!0},therapy:{type:Object,required:!0}},setup(o){const t=V({employee:"",date:"",amount:0,status:!0,concept:"",payrollsDetails:[],payment_methods_id:"",amount_pay:0,reference:"",capture:null});return(a,r)=>(n(),v(D,null,{header:s(()=>[]),default:s(()=>[e("div",ie,[e("div",ue,[ce,l(b($),{href:a.route("payrolls.index"),class:"w-full inline-flex mx-3 items-center justify-center w-1/2 px-3 py-2 text-sm font-medium text-center text-white rounded-lg bg-gray-800 hover:bg-gray-700 focus:ring-4 focus:ring-blue-300 sm:w-auto dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},{default:s(()=>[me,d(" Volver ")]),_:1},8,["href"])]),e("div",pe,[ge,l(ne,{form:b(t),employees:o.employees,payment_methods:o.payment_methods,therapy:o.therapy,onSubmit:r[0]||(r[0]=y=>b(t).post(a.route("payrolls.store")))},null,8,["form","employees","payment_methods","therapy"])])])]),_:1}))}});export{Se as default};
